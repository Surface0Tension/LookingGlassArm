ROM php:7.4-cli
COPY . /usr/src/myapp
WORKDIR /usr/src/myapp

# Install basics
RUN apt-get update && apt-get install -y git host mtr iputils-ping traceroute sqlite3

# ENV
ENV IPV4
ENV IPV6
ENV LOCATION
#0 for nolimit
ENV RATELIMIT
#Header/Logo
ENV SITE
#Enter the public URL to this LG (including http://)
ENV URL http://localhost:80
#(5MB 10MB)
ENV TEST
# Theme:
# 1) cerulean
# 2) readable
# 3) spacelab
# 4) united
# Demo: http://lg.iamtelephone.com/themes
ENV THEME cerulean

# Download Looking Glass
RUN ["git", "clone", "https://github.com/Surface0Tension/LookingGlass.git"]

# Setting up Lookihg Glass and exec
CMD ["./LookingGlass/LookingGlass/configure.sh", "$IPV4", "$IPV6", "$LOCATION", "$RATELIMIT", "$SITE", "$URL", "$TEST", "$THEME" && "php", "./LookingGlass/LookingGlass/LookingGlass.php"]
